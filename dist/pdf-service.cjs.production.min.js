"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,t=(e=require("fs"))&&"object"==typeof e&&"default"in e?e.default:e,o=require("stream"),r=require("@adobe/pdfservices-node-sdk");exports.PdfService=function(){function e(){}var n=e.prototype;return n.credentials=function(){return r.Credentials.serviceAccountCredentialsBuilder().fromFile("pdfservices-api-credentials.json").build()},n.convertToPdf=function(e){void 0===e&&(e="createPDF");try{var t=this.credentials(),o=r.ExecutionContext.create(t),n=r.CreatePDF.Operation.createNew(),c=r.FileRef.createFromLocalFile("resources/createPDFInput.docx");n.setInput(c),n.execute(o).then((function(t){return t.saveAsFile("output/"+e+".pdf")}))}catch(e){throw console.log(e),new Error("Failed to Convert into PDF")}},n.mergeJsonToDocStream=function(e,o,n){try{var c=this.credentials(),i=o,u=r.ExecutionContext.create(c),s=r.DocumentMerge,a=s.options,l=new a.DocumentMergeOptions(i,a.OutputFormat.PDF),d=s.Operation.createNew(l),f=process.cwd()+"/output/"+n;t.existsSync(f)?(console.log("File exists."),t.unlinkSync(f)):console.log("File does not exist.");var p=this.bufferToStream(e);console.log("Buffer to Stream"),console.log(p);var F=r.FileRef.createFromStream(p,r.CreatePDF.SupportedSourceFormat.docx);d.setInput(F),d.execute(u).then((function(e){e.saveAsFile("./output/"+n+".pdf")})).catch((function(e){throw new Error(e.message)}))}catch(e){throw console.log("Exception encountered while executing operation",e),new Error("Failed to Merge JSON with Document")}},n.bufferToStream=function(e){return new o.Readable({read:function(){this.push(e),this.push(null)}})},e}();
//# sourceMappingURL=pdf-service.cjs.production.min.js.map
